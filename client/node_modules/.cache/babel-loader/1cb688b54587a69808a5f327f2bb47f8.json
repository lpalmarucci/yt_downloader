{"ast":null,"code":"var _jsxFileName = \"/Users/palma/Desktop/apollo/youtube_dl/client/src/components/Login.js\",\n    _s = $RefreshSig$();\n\nimport Header from \"./Header\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Button, TextField, Typography, Container } from '@material-ui/core';\nimport Alert from '@material-ui/lab/Alert';\nimport loginMutation from \"./managers/mutations/login\";\nimport UserProvider from \"../providers/UserProvider\"; //Managing cookies\n\nimport Cookies from 'universal-cookie';\nimport { useHistory } from \"react-router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport AuthenticationReducer from \"../store/reducers/AuthenticationReducer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst cookie = new Cookies();\n\nconst Login = () => {\n  _s();\n\n  const [email, setEmail] = useState(\"bob@gmail.com\");\n  const [password, setPassword] = useState(\"bob\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const dispatchUser = useDispatch(AuthenticationReducer);\n  const userState = useSelector(state => state);\n  useEffect(() => console.log(\"userState init --> \", userState), []);\n  const {\n    setUserContext\n  } = useContext(UserProvider);\n  const history = useHistory();\n\n  const handleLoginClick = e => {\n    e.preventDefault();\n\n    if (email.length === 0 || password.length === 0) {\n      setErrorMessage(\"Valorizzare tutti i campi\");\n    } else {\n      fetch('http://localhost:4000/graphql', {\n        credentials: 'include',\n        method: \"POST\",\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': '*/*'\n        },\n        body: JSON.stringify({\n          query: loginMutation,\n          variables: {\n            email: email,\n            password: password\n          }\n        })\n      }).then(res => res.json()).then(res => {\n        var _res$data, _res$data$login, _res$data2, _res$data2$login;\n\n        console.log(res);\n\n        if (((_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$login = _res$data.login) === null || _res$data$login === void 0 ? void 0 : _res$data$login.accessToken) && ((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : (_res$data2$login = _res$data2.login) === null || _res$data2$login === void 0 ? void 0 : _res$data2$login.username)) {\n          setUserContext(res.data.login.username);\n          dispatchUser({\n            type: 'login',\n            payload: res.data.login.username\n          });\n          console.log();\n        } else {\n          if (res.errors && res.errors.length > 0) {\n            setErrorMessage(res.errors[0].message);\n          }\n        }\n\n        history.push('/home');\n      });\n    }\n\n    console.log(\"Handle click\");\n  };\n\n  var displayErrorMessage = /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 28\n  }, this);\n\n  if (errorMessage.length > 0) {\n    displayErrorMessage = /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      style: {\n        \"marginTop\": \"10px\"\n      },\n      children: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 25\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"5%\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        component: \"main\",\n        maxWidth: \"xs\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h1\",\n            variant: \"h5\",\n            children: \"Sign in\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            noValidate: true,\n            method: \"POST\",\n            children: [/*#__PURE__*/_jsxDEV(TextField, {\n              variant: \"outlined\",\n              margin: \"normal\",\n              required: true,\n              fullWidth: true,\n              id: \"email\",\n              label: \"Email\",\n              name: \"email\",\n              autoComplete: \"email\",\n              autoFocus: true,\n              onChange: e => {\n                setEmail(e.target.value);\n                setErrorMessage(\"\");\n              },\n              value: email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(TextField, {\n              variant: \"outlined\",\n              margin: \"normal\",\n              required: true,\n              fullWidth: true,\n              name: \"password\",\n              label: \"Password\",\n              type: \"password\",\n              id: \"password\",\n              autoComplete: \"current-password\",\n              onChange: e => {\n                setPassword(e.target.value);\n                setErrorMessage(\"\");\n              },\n              value: password\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              type: \"submit\",\n              fullWidth: true,\n              variant: \"contained\",\n              color: \"primary\",\n              style: {\n                marginTop: \"10px\"\n              },\n              onClick: handleLoginClick,\n              children: \"Sign In\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 8\n            }, this), displayErrorMessage]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Login, \"E16cjs/zeTC8jNXbVnnU++9OY3Y=\", false, function () {\n  return [useDispatch, useSelector, useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/palma/Desktop/apollo/youtube_dl/client/src/components/Login.js"],"names":["Header","React","useContext","useEffect","useState","Button","TextField","Typography","Container","Alert","loginMutation","UserProvider","Cookies","useHistory","useDispatch","useSelector","AuthenticationReducer","cookie","Login","email","setEmail","password","setPassword","errorMessage","setErrorMessage","dispatchUser","userState","state","console","log","setUserContext","history","handleLoginClick","e","preventDefault","length","fetch","credentials","method","headers","body","JSON","stringify","query","variables","then","res","json","data","login","accessToken","username","type","payload","errors","message","push","displayErrorMessage","marginTop","target","value"],"mappings":"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","sourcesContent":["import Header from \"./Header\"\nimport React, { useContext, useEffect, useState } from 'react'\nimport { Button, TextField, Typography, Container } from '@material-ui/core';\nimport Alert from '@material-ui/lab/Alert';\nimport loginMutation from \"./managers/mutations/login\";\nimport UserProvider from \"../providers/UserProvider\";\n\n//Managing cookies\nimport Cookies from 'universal-cookie'\nimport { useHistory } from \"react-router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport AuthenticationReducer from \"../store/reducers/AuthenticationReducer\";\nconst cookie = new Cookies();\n\nconst Login = () => {\n\tconst [email, setEmail] = useState(\"bob@gmail.com\");\n\tconst [password, setPassword] = useState(\"bob\");\n\tconst [errorMessage, setErrorMessage] = useState(\"\");\n\n\tconst dispatchUser = useDispatch(AuthenticationReducer);\n\tconst userState = useSelector(state => state)\n\t\n\tuseEffect(() => console.log(\"userState init --> \",userState), []);\n\n\tconst { setUserContext } = useContext(UserProvider);\n\n\tconst history = useHistory();\n\n\tconst handleLoginClick = (e) => {\n\t\te.preventDefault();\n\t\tif (email.length === 0 || password.length === 0) {\n\t\t\tsetErrorMessage(\"Valorizzare tutti i campi\");\n\t\t} else {\n\t\t\tfetch('http://localhost:4000/graphql', {\n\t\t\t\tcredentials: 'include',\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'Accept': '*/*'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tquery: loginMutation,\n\t\t\t\t\tvariables: { email: email, password: password }\n\t\t\t\t})\n\t\t\t}).then(res => res.json()).then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tif (res.data?.login?.accessToken && res.data?.login?.username) {\n\t\t\t\t\tsetUserContext(res.data.login.username);\n\t\t\t\t\tdispatchUser({type: 'login', payload: res.data.login.username});\n\n\t\t\t\t\tconsole.log()\n\t\t\t\t} else {\n\t\t\t\t\tif (res.errors && res.errors.length > 0) {\n\t\t\t\t\t\tsetErrorMessage(res.errors[0].message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\thistory.push('/home');\n\t\t\t});\n\t\t}\n\n\t\tconsole.log(\"Handle click\",)\n\t}\n\tvar displayErrorMessage = <div></div>;\n\tif (errorMessage.length > 0) {\n\t\tdisplayErrorMessage = <Alert\n\t\t\tseverity=\"error\"\n\t\t\tstyle={{ \"marginTop\": \"10px\" }}>\n\t\t\t{errorMessage}\n\t\t</Alert>\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<Header />\n\t\t\t<div style={{ marginTop: \"5%\" }}>\n\t\t\t\t<Container component=\"main\" maxWidth=\"xs\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Typography component=\"h1\" variant=\"h5\">\n\t\t\t\t\t\t\tSign in\n                        </Typography>\n\t\t\t\t\t\t<form noValidate method=\"POST\">\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tid=\"email\"\n\t\t\t\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\t\t\tautoComplete=\"email\"\n\t\t\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\t\t\tonChange={(e) => {setEmail(e.target.value); setErrorMessage(\"\")}}\n\t\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\tmargin=\"normal\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\t\t\tautoComplete=\"current-password\"\n\t\t\t\t\t\t\t\tonChange={(e) => { setPassword(e.target.value); setErrorMessage(\"\") }}\n\t\t\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\tstyle={{ marginTop: \"10px\" }}\n\t\t\t\t\t\t\t\tonClick={handleLoginClick}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSign In\n                            </Button>\n\t\t\t\t\t\t\t{/* Show/Hide error message */}\n\t\t\t\t\t\t\t{displayErrorMessage}\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</Container>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Login"]},"metadata":{},"sourceType":"module"}